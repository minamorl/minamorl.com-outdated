<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="initial-scale=1"><link rel="stylesheet" href="../lib/normalize.css" type="text/css"><link rel="stylesheet" href="../css/main.css" type="text/css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/tomorrow.min.css" type="text/css"><title>git-addをgulp-gitを用いて自動化する - minamorl.com</title><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js" charset="utf-8"></script><script>hljs.initHighlightingOnLoad();</script></head><body><header><div class="content"><a href="/" class="logo">minamorl.com</a></div></header><div class="content"><article><h1>git-addをgulp-gitを用いて自動化する</h1><time>2015-08-06T01:02:34+0900</time><div><h2 id="-">モチベーション</h2><p>このサイトはgulpを用いてmarkdownファイルからすべて静的ファイルが自動生成されているが、articles以下のファイルを更新したあとgulpコマンドを実行したとき、いちいち手動で<code>git add articles</code>などとやるのは煩わしい。</p><p><blockquote class="twitter-tweet" lang="ja"><p lang="ja" dir="ltr">今のサイト、distフォルダ以下をデプロイしたいんだけどarticlesとdistを両方addするの毎回忘れる</p>&mdash; みなもーる (@minamorl) <a href="https://twitter.com/minamorl/status/628947062860574720">2015, 8月 5</a></blockquote></p><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p><blockquote class="twitter-tweet" lang="ja"><p lang="ja" dir="ltr">bareリポジトリからpost-receiveでgulp実行してページ生成するの一瞬考えたけどサーバー側にnpm入れたり色々と最悪な感じしかしないからこの案はやめだな 全部git関係はgulp-gitに収めてgulp経由でしか触らないとか</p>&mdash; みなもーる (@minamorl) <a href="https://twitter.com/minamorl/status/628947551220137984">2015, 8月 5</a></blockquote></p><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p><blockquote class="twitter-tweet" lang="ja"><p lang="ja" dir="ltr">折衷案としてgulpのタスクからページ生成～git.addまでを実行するようにしてコミットしてプッシュする流れは手動でやることにした</p>&mdash; みなもーる (@minamorl) <a href="https://twitter.com/minamorl/status/628955502387462144">2015, 8月 5</a></blockquote></p><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p>したがって自動でarticles以下のファイルとdist以下のファイルをコミット対象に追加してほしい。</p><h2 id="-">サンプル</h2><pre><code class="lang-sh">sudo npm install gulp-git --save-dev
</code></pre><p>とした後、gulpfile.coffeeに次のように追加する。</p><pre><code class="lang-coffeescript">git = require &#39;gulp-git&#39;

gulp.task &#39;git-add&#39;, -&gt;
  gulp.src [&#39;./articles/**/*.md&#39;, &#39;./dist/**/*&#39;]
    .pipe git.add()
</code></pre><p>このようにシンプルなタスクを生成しgulpのデフォルトタスクに追加してやると想定通りの挙動が得られる。</p></div></article><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = 'minamorl';
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script></div></body></html>