<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="initial-scale=1.0"><link rel="stylesheet" href="/lib/normalize.css" type="text/css"><link rel="stylesheet" href="/css/main.css" type="text/css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/default.min.css" type="text/css"><title>minamorl.com</title><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js" charset="utf-8"></script><script>hljs.initHighlightingOnLoad();</script></head><body><header><div class="content"><a href="/" class="logo">minamorl.com</a></div></header><div class="content"><article><h1>Gulpを用いてmarkdownから静的HTMLファイルの生成を行う</h1><time>2015-07-31T11:22:58+0900</time><div><h2 id="-">モチベーション</h2>
<p>staticなWebサイトジェネレータを探していたが何となく既存のものを使いたくなかったので、Gulpから直接生成する手段はないか検討していた</p>
<p>つまり</p>
<pre><code>gulp markdown
</code></pre><p>と入力しただけで<code>/articles/**/*.md</code>ファイルから、markdownをコンパイルした状態で自動的にJadeテンプレートを適応し、<code>/dist/articles/**/*.html</code>ファイルを生成してほしい。</p>
<h2 id="-">このサイトの実装</h2>
<pre><code class="lang-coffeescript">gulp        = require &#39;gulp&#39;
frontMatter = require &#39;gulp-front-matter&#39;
layout      = require &#39;gulp-layout&#39;
markdown    = require &#39;gulp-markdown&#39;
jade        = require &#39;gulp-jade&#39;
tap         = require &#39;gulp-tap&#39;
path        = require &#39;path&#39;

// ...

gulp.task &#39;markdown&#39;, -&gt;
  defaultLayout =
    layout: &quot;templates/article.jade&quot;
  gulp.src &#39;articles/**/*.md&#39;
    .pipe frontMatter()
    .pipe markdown()
    .pipe layout ((file) -&gt;
      merge(defaultLayout, file.frontMatter)
    )
    .pipe tap((file) -&gt;
      extname = path.extname(path)
      name =
        dirname:  path.dirname(file.path),
        basename: path.basename(file.path, extname),
      file.path = path.join name.dirname, file.frontMatter.timestamp + &quot;-&quot; + name.basename
    )
    .pipe gulp.dest(&#39;./dist/articles&#39;)
</code></pre>
<p>gulp-front-matterはmarkdownファイルからYAML front matterをparseしてfile.frontMatterに格納して返してくれる。あとはmarkdownに処理させてlayoutからJadeをぶん投げて保存するだけ。</p>
<p>tap内の処理はrename時にfrontMatterの情報を使いたかったからで、普通はgulp-renameでも使えばいいと思います。</p>
<h2 id="-">結論</h2>
<p>普通にJekyllとかそのへんのジェネレータ使ったほうが幸せになれる。</p>
</div></article><footer><div class="articles"><h2>articles</h2><ul><li> <a href="articles/2015-07-31T11:22:58+0900-how-to-make-static-page-genereator-with-gulp.html">2015-07-31T11:22:58+0900-how-to-make-static-page-genereator-with-gulp.html</a></li><li> <a href="articles/2015-07-31T03:27:03+0900-testpage.html">2015-07-31T03:27:03+0900-testpage.html</a></li></ul></div><div class="log"><h2>log</h2><p>デザインの調整 - <time>2015-07-30 17:42:24<time></p><p>viewportの指定とか - <time>2015-07-27 22:01:10</time></p><p>適当にドメインとってサーバ建ててCNAMEとか設定してnginx入れてpost-receive hook使ってgit pushしたら自動的に中身を更新するようにした。 - <time>2015-07-27 19:18:10</time></p></div><div class="bio"><h2>bio</h2><p>name: minamorl</p><p>twitter: <a href="https://twitter.com/minamorl/">@minamorl</a></p><ul><li>ドール(azone)</li><li>熱帯魚の飼育・多肉植物栽培などを中心に生活している</li><li>医薬品検索エンジンChlorixの開発に携わった</li></ul></div></footer></div></body></html>